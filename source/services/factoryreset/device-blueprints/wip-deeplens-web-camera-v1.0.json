{
    "CoreDefinitionVersion": {
        "Cores": [{
            "SyncShadow": true,
            "ThingArn": "[CORE_ARN]",
            "CertificateArn": "[CORE_CERTIFICATE_ARN]"
        }]
    },
    "FunctionDefinitionVersion": {
        "Functions": [{
                "FunctionArn": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:deeplens_admin_model_downloader:1",
                "FunctionConfiguration": {
                    "MemorySize": 160000,
                    "Environment": {
                        "Variables": {},
                        "AccessSysfs": true,
                        "ResourceAccessPolicies": [{
                            "Permission": "rw",
                            "ResourceId": "artifacts"
                        }]
                    },
                    "Executable": "das_mutter.function_handler",
                    "Pinned": true,
                    "Timeout": 1200
                }
            },
            {
                "FunctionArn": "arn:aws:lambda:::function:GGIPDetector:1",
                "FunctionConfiguration": {
                    "MemorySize": 32768,
                    "Environment": {
                        "Variables": {},
                        "AccessSysfs": true
                    },
                    "Pinned": true,
                    "Timeout": 3
                }
            },
            {
                "FunctionArn": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:deeplens_admin_version_poller:1",
                "FunctionConfiguration": {
                    "MemorySize": 160000,
                    "Environment": {
                        "Variables": {},
                        "AccessSysfs": true,
                        "ResourceAccessPolicies": [{
                            "Permission": "rw",
                            "ResourceId": "artifacts"
                        }]
                    },
                    "Executable": "version_poller.function_handler",
                    "Pinned": true,
                    "Timeout": 1200
                }
            },
            {
                "FunctionArn": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:mtm-gg-deeplens-simple-camera-python:MTM",
                "FunctionConfiguration": {
                    "MemorySize": 131072,
                    "Environment": {
                        "Variables": {},
                        "AccessSysfs": false,
                        "ResourceAccessPolicies": [{
                            "Permission": "rw",
                            "ResourceId": "tmp"
                        }, {
                            "Permission": "ro",
                            "ResourceId": "aws_cam_home"
                        }, {
                            "Permission": "ro",
                            "ResourceId": "stream"
                        }]
                    },
                    "Executable": "lambda_function.lambda_handler",
                    "Pinned": true,
                    "Timeout": 3
                }
            }
        ]
    },
    "LoggerDefinitionVersion": {
        "Loggers": [{
                "Type": "AWSCloudWatch",
                "Level": "INFO",
                "Id": "deeplens-greengrass-AWSCloudWatch-GreengrassSystem",
                "Component": "GreengrassSystem"
            },
            {
                "Type": "AWSCloudWatch",
                "Level": "INFO",
                "Id": "deeplens-greengrass-AWSCloudWatch-Lambda",
                "Component": "Lambda"
            },
            {
                "Space": 300000,
                "Type": "FileSystem",
                "Level": "INFO",
                "Id": "deeplens-greengrass-FileSystem-GreengrassSystem",
                "Component": "GreengrassSystem"
            },
            {
                "Space": 300000,
                "Type": "FileSystem",
                "Level": "INFO",
                "Id": "deeplens-greengrass-FileSystem-Lambda",
                "Component": "Lambda"
            }
        ]
    },
    "ResourceDefinitionVersion": {
        "Resources": [{
            "ResourceDataContainer": {
                "LocalVolumeResourceData": {
                    "SourcePath": "/opt/awscam/artifacts/",
                    "DestinationPath": "/opt/awscam/artifacts/",
                    "GroupOwnerSetting": {
                        "AutoAddGroupOwner": true
                    }
                }
            },
            "Id": "artifacts",
            "Name": "dc_admin_artifacts_resource"
        }, {
            "Id": "tmp",
            "Name": "tmp",
            "ResourceDataContainer": {
                "LocalVolumeResourceData": {
                    "DestinationPath": "/tmp",
                    "GroupOwnerSetting": {
                        "AutoAddGroupOwner": true
                    },
                    "SourcePath": "/tmp"
                }
            }
        }, {
            "Id": "stream",
            "Name": "stream_resource",
            "ResourceDataContainer": {
                "LocalVolumeResourceData": {
                    "DestinationPath": "/opt/awscam/out",
                    "GroupOwnerSetting": {
                        "AutoAddGroupOwner": true
                    },
                    "SourcePath": "/opt/awscam/out"
                }
            }
        }, {
            "Id": "aws_cam_home",
            "Name": "aws_home_dir",
            "ResourceDataContainer": {
                "LocalVolumeResourceData": {
                    "DestinationPath": "/home/aws_cam/",
                    "GroupOwnerSetting": {
                        "AutoAddGroupOwner": true
                    },
                    "SourcePath": "/home/aws_cam/"
                }
            }
        }]
    },
    "SubscriptionDefinitionVersion": {
        "Subscriptions": [{
                "Target": "cloud",
                "Source": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:deeplens_admin_model_downloader:1",
                "Subject": "$aws/things/[THING_NAME]/shadow/update"
            },
            {
                "Target": "cloud",
                "Source": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:deeplens_admin_version_poller:1",
                "Subject": "$aws/things/[THING_NAME]/shadow/update"
            },
            {
                "Target": "cloud",
                "Source": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:mtm-gg-deeplens-simple-camera-python:MTM",
                "Subject": "mtm/[THING_NAME]/camera"
            },
            {
                "Target": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:mtm-gg-deeplens-simple-camera-python:MTM",
                "Source": "cloud",
                "Subject": "mtm/[THING_NAME]/trigger"
            }
        ]
    },
    "IAM": {
        "PolicyArns": [
            "[MYTHINGS_MGMT_DATA_BUCKET_ACCESS_POLICY]"
        ]
    },
    "Metadata": {
        "ggBlueprintId": "my-deeplens-web-camera-v1.0",
        "name": "My Deeplens Web Camera v1.0"
    }

}
