{
    "id": "aws-image-capture-v1.0",
    "name": "AWS Image Capture v1.0",
    "type": "GREENGRASS",
    "compatibility": ["aws-deeplens-no-lambda-v1.0"],
    "deviceTypeMappings": [{
        "substitute": "AWS_CAM_STREAM",
        "value": {
            "aws-deeplens-no-lambda-v1.0": "stream"
        }
    }],
    "spec": {
        "Shadow": {
            "desired": {
                "simpleCamera": {
                    "capture": "Off",
                    "sleepInSecsAsStr": "0.5",
                    "s3UploadSleepInSecsAsStr": "0.5",
                    "s3Upload": "Off",
                    "s3Bucket": "[DATA_BUCKET]",
                    "resolution": "858x480",
                    "s3KeyPrefix": "aws-image-capture-v1.0/[CORE]/default"
                }
            }
        },
        "FunctionDefinitionVersion": {
            "Functions": [{
                "FunctionArn": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:aws-image-capture-python:MTM",
                "FunctionConfiguration": {
                    "EncodingType": "json",
                    "Environment": {
                        "AccessSysfs": false,
                        "ResourceAccessPolicies": [{
                                "Permission": "rw",
                                "ResourceId": "tmp"
                            },
                            {
                                "Permission": "ro",
                                "ResourceId": "[AWS_CAM_STREAM]"
                            },
                            {
                                "Permission": "rw",
                                "ResourceId": "gpu"
                            }
                        ],
                        "Variables": {}
                    },
                    "MemorySize": 2097152,
                    "Pinned": true,
                    "Timeout": 25
                }
            }]
        },
        "SubscriptionDefinitionVersion": {
            "Subscriptions": [{
                    "Source": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:aws-image-capture-python:MTM",
                    "Subject": "mtm/[CORE]/logger",
                    "Target": "cloud"
                }, {
                    "Source": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:aws-image-capture-python:MTM",
                    "Subject": "mtm/[CORE]/camera",
                    "Target": "cloud"
                }, {
                    "Source": "GGShadowService",
                    "Subject": "$aws/things/[CORE]/shadow/update/accepted",
                    "Target": "arn:aws:lambda:[AWS_REGION]:[AWS_ACCOUNT]:function:aws-image-capture-python:MTM"
                }
            ]
        }
    }
}
